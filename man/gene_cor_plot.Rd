% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{gene_cor_plot}
\alias{gene_cor_plot}
\alias{gene_cor_plot,omicscope-method}
\title{Create Correlation Scatter Plots Between Two Genes}
\usage{
gene_cor_plot(object, ...)

\S4method{gene_cor_plot}{omicscope}(
  object,
  gene_1 = NULL,
  gene_2 = NULL,
  point_col = "#F97A00",
  line_col = "#205781",
  point_size = 1,
  selected_group = c("Tumor", "Normal", "both")
)
}
\arguments{
\item{object}{An object of class \code{omicscope} containing normalized
expression data and sample metadata.}

\item{...}{Additional arguments (currently not used).}

\item{gene_1}{Character string specifying the first gene name (x-axis).
Required parameter. Must exist in the normalized data.}

\item{gene_2}{Character string specifying the second gene name (y-axis).
Required parameter. Must exist in the normalized data.}

\item{point_col}{Character string specifying the color of scatter points.
Default is \code{"#F97A00"} (orange).}

\item{line_col}{Character string specifying the color of the regression line.
Default is \code{"#205781"} (blue).}

\item{point_size}{Numeric value specifying the size of scatter points.
Default is \code{1}.}

\item{selected_group}{Character string specifying which sample group(s) to
plot. Options are \code{"Tumor"} (tumor samples only), \code{"Normal"}
(normal samples only), or \code{"both"} (separate facets for each group).
Default is \code{"Tumor"}.}
}
\value{
A \code{ggplot2} object displaying the gene correlation scatter plot(s)
with linear regression lines and Pearson correlation statistics.
}
\description{
This function generates scatter plots to visualize the correlation between
expression levels of two selected genes. Pearson correlation coefficients
and p-values are calculated and displayed on the plots. Plots can be
stratified by sample groups (Normal, Tumor, or both).
}
\details{
The function workflow includes:
\itemize{
\item Extracts normalized expression data from the \code{omicscope} object
\item Filters samples based on the \code{selected_group} parameter
\item Extracts expression values for the two specified genes
\item Creates scatter plots with linear regression lines (using \code{lm} method)
\item Calculates and displays Pearson correlation coefficient with p-value
\item When \code{selected_group = "both"}, creates faceted plots for Normal and Tumor groups
}

The function requires that normalized data has been generated first using the
\code{get_normalized_data} function. Expression values are used in their
original scale (not log-transformed) for correlation analysis.
}
\note{
\itemize{
\item Gene names are case-sensitive and must match exactly with those in the data
\item The aspect ratio is fixed at 1:1 for better visual interpretation
\item Correlation method used is Pearson's correlation coefficient
}
}
\examples{
\dontrun{
# Correlation plot for tumor samples only
gene_cor_plot(obj,
              gene_1 = "METTL3",
              gene_2 = "METTL5")

# Correlation plot comparing both Normal and Tumor groups
gene_cor_plot(obj,
              gene_1 = "METTL3",
              gene_2 = "METTL14",
              selected_group = "both")

# Customize colors and point size
gene_cor_plot(obj,
              gene_1 = "ACTB",
              gene_2 = "GAPDH",
              point_col = "#E64B35FF",
              line_col = "#4DBBD5FF",
              point_size = 2,
              selected_group = "Normal")
}




}
