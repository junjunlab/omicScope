% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization.R
\name{volcano_plot}
\alias{volcano_plot}
\alias{volcano_plot,omicscope-method}
\title{Create Volcano Plot for Differential Expression Results}
\usage{
volcano_plot(object, ...)

\S4method{volcano_plot}{omicscope}(
  object,
  method = c("deseq2", "edger", "limma"),
  marker_gene = NULL,
  top_gene = 10,
  gene_label_size = 3,
  gene_number_size = 4,
  gene_number_label_pos = c(0.95, 0.95),
  point_size = 1,
  color = c("#AF1740", "grey", "#074799"),
  nrow = NULL
)
}
\arguments{
\item{object}{An \code{omicscope} S4 object containing differential expression results.
The object must have differential expression data in the \code{diffExpData} slot
(run \code{differential_expression} first).}

\item{...}{Additional arguments (currently not used).}

\item{method}{Character string specifying which differential expression method
results to plot. Options are:
\itemize{
\item \code{"deseq2"} - Plot DESeq2 results
\item \code{"edger"} - Plot edgeR results
\item \code{"limma"} - Plot limma results
}
Default is \code{c("deseq2","edger","limma")}, which will use "deseq2" as first choice.}

\item{marker_gene}{A character vector of gene names to highlight on the plot.
If \code{NULL} (default), the top significant genes will be labeled instead.}

\item{top_gene}{An integer specifying how many top significant genes to label
when \code{marker_gene} is NULL. Default is 10. Set to 0 to disable gene labeling.
Top genes are selected based on lowest p-values within each significance category.}

\item{gene_label_size}{Numeric value specifying the size of gene name labels.
Default is 3.}

\item{gene_number_size}{Numeric value specifying the size of the gene count
labels (e.g., "sigUp: 150"). Default is 4.}

\item{gene_number_label_pos}{A numeric vector of length 2 specifying the position
of gene count labels as normalized coordinates (0-1). Default is \code{c(0.95, 0.95)}
for top-right corner positioning.}

\item{point_size}{Numeric value specifying the size of points in the scatter plot.
Default is 1.}

\item{color}{A character vector of length 3 specifying colors for significantly
upregulated, non-significant, and significantly downregulated genes respectively.
Default is \code{c("#AF1740", "grey", "#074799")} (red, grey, blue).}

\item{nrow}{An integer specifying the number of rows when multiple comparisons
are plotted. If \code{NULL} (default), \code{cowplot} will determine the layout automatically.}
}
\value{
A \code{ggplot2} object (for single comparison) or a \code{cowplot} grid
object (for multiple comparisons) showing volcano plots with the following features:
\itemize{
\item Points colored by significance status
\item Horizontal dashed line at p-value threshold
\item Vertical dashed lines at log2FC thresholds
\item Optional gene labels for top significant or specified marker genes
\item Gene count annotations in corners
}
}
\description{
This function creates volcano plots to visualize differential expression results
stored in an omicscope object. It displays log2 fold change vs -log10(p-value)
with color-coded significance levels and optional gene labeling.
}
\examples{
\dontrun{
# Basic volcano plot with default settings
p1 <- volcano_plot(obj, method = "deseq2")
print(p1)

# Plot without gene labels
p2 <- volcano_plot(obj, method = "edger", top_gene = 0)
print(p2)

# Highlight specific marker genes
markers <- c("GAPDH", "ACTB", "TP53", "MYC")
p3 <- volcano_plot(obj,
                   method = "limma",
                   marker_gene = markers)
print(p3)

# Customize appearance
p4 <- volcano_plot(obj,
                   method = "deseq2",
                   top_gene = 5,
                   point_size = 1.5,
                   gene_label_size = 4,
                   color = c("red", "darkgrey", "blue"))
print(p4)

# Multiple comparisons in custom layout
p5 <- volcano_plot(obj, nrow = 2)
print(p5)
}


}
