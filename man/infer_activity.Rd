% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference-activity.R
\name{infer_activity}
\alias{infer_activity}
\alias{infer_activity,omicscope-method}
\title{Infer Pathway or Transcription Factor Activity}
\usage{
infer_activity(object, ...)

\S4method{infer_activity}{omicscope}(
  object,
  input_type = c("counts", "diff_data"),
  diff_data_obj = NULL,
  organism = c("human", "mouse", "rat"),
  statistics = "mlm",
  infer_type = c("pathway", "tf"),
  decouple_params = list(),
  use_local_netdata = FALSE
)
}
\arguments{
\item{object}{An \code{omicscope} object containing gene expression data and metadata.}

\item{...}{Additional arguments (currently not used)}

\item{input_type}{Character string specifying the type of input data. Options are:
\itemize{
\item \code{"counts"}: Use raw count data from the \code{counts} assay
\item \code{"diff_data"}: Use differential expression statistics
}}

\item{diff_data_obj}{A differential expression data object. Required when
\code{input_type = "diff_data"}. Should be from \code{object@diffExpData}
(e.g., \code{object@diffExpData$deseq2$treat_vs_control}).}

\item{organism}{Character string specifying the organism. Supported options:
\code{"human"}, \code{"mouse"}, \code{"rat"}. Default is \code{"human"}.}

\item{statistics}{Character string specifying the statistical method to use.
Default is \code{"mlm"} (multivariate linear model). Other options include
\code{"ulm"} (univariate linear model), \code{"wsum"} (weighted sum), etc.}

\item{infer_type}{Character string specifying what to infer. Options are:
\itemize{
\item \code{"pathway"}: Infer pathway activities using PROGENy networks
\item \code{"tf"}: Infer transcription factor activities using CollecTRI networks
}}

\item{decouple_params}{A list of additional parameters to pass to
\code{decoupleR::decouple()}. Default is an empty list.}

\item{use_local_netdata}{Logical indicating whether to use local network data
bundled with the package (\code{TRUE}) or download from online databases
(\code{FALSE}). Default is \code{FALSE}.}
}
\value{
An \code{omicscope} object with activity inference results stored in
the \code{@activityData} slot as an \code{activitydata} object.
}
\description{
This function infers pathway or transcription factor (TF) activity from gene expression data
using the decoupleR framework. It supports both count data and differential expression data
as input, and can analyze either pathway activities or transcription factor activities.
}
\details{
The function performs the following steps:
\enumerate{
\item Extracts gene annotations and validates input data
\item Processes input data based on \code{input_type}:
\itemize{
\item For \code{"counts"}: Converts to CPM (counts per million)
\item For \code{"diff_data"}: Extracts appropriate statistics based on the
differential expression method (DESeq2: stat, edgeR: -log10(p)*log2FC,
limma: t-statistic)
}
\item Loads appropriate network data:
\itemize{
\item For \code{infer_type = "pathway"}: Uses PROGENy pathway-gene networks
\item For \code{infer_type = "tf"}: Uses CollecTRI transcription factor-gene networks
}
\item Runs activity inference using \code{decoupleR::decouple()}
\item Returns the updated \code{omicscope} object with results
}
}
\note{
\itemize{
\item When using \code{input_type = "counts"}, the function requires a \code{"counts"}
assay in the \code{omicscope} object
\item For \code{input_type = "diff_data"}, the function automatically selects
appropriate statistics based on the differential expression method
\item The \code{mlm} method may fail with highly correlated regulators. Consider
using \code{statistics = "ulm"} or \code{statistics = "wsum"} as alternatives
\item Gene names are made unique using \code{make.unique()} to avoid duplicates
}
}
\section{Network Data Sources}{

\itemize{
\item \strong{PROGENy}: Pathway RespOnsive GENes for activity inference
\item \strong{CollecTRI}: A comprehensive resource of transcriptional regulation
}
}

\section{Statistical Methods}{

\itemize{
\item \strong{mlm}: Multivariate Linear Model - fits all regulators simultaneously
\item \strong{ulm}: Univariate Linear Model - fits each regulator independently
\item \strong{wsum}: Weighted Sum - simple weighted aggregation of target genes
}
}

\examples{
\dontrun{
# Infer pathway activities from count data
os_pathway <- infer_activity(os,
                            input_type = "counts",
                            infer_type = "pathway",
                            organism = "mouse",
                            use_local_netdata = TRUE)

# Infer pathway activities from differential expression data
os_pathway <- infer_activity(os,
                            input_type = "diff_data",
                            diff_data_obj = os@diffExpData$deseq2$treat_vs_control,
                            infer_type = "pathway",
                            organism = "mouse")

# Infer transcription factor activities using ULM method
os_tf <- infer_activity(os,
                       input_type = "counts",
                       infer_type = "tf",
                       organism = "mouse",
                       statistics = "ulm",
                       use_local_netdata = TRUE)

# Use custom parameters for decoupleR
os_custom <- infer_activity(os,
                           input_type = "counts",
                           infer_type = "pathway",
                           organism = "human",
                           decouple_params = list(minsize = 10,
                                                 consensus_score = TRUE))
}



}
