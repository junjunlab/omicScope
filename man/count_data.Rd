% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/count-data.R
\name{count_data}
\alias{count_data}
\alias{count_data,omicscope-method}
\title{Count RNA-seq reads using featureCounts}
\usage{
count_data(object, ...)

\S4method{count_data}{omicscope}(
  object,
  rna_pairedEnd = TRUE,
  nThreads = 1,
  featureCounts_params = list()
)
}
\arguments{
\item{object}{An omicscope object containing sample information and GTF annotation path}

\item{...}{Additional arguments (currently not used)}

\item{rna_pairedEnd}{Logical value indicating whether the RNA-seq data is paired-end.
Default is TRUE}

\item{nThreads}{Integer specifying the number of threads to use for counting.
Default is 1}

\item{featureCounts_params}{List of additional parameters to pass to
\code{\link[Rsubread]{featureCounts}}. These will override default parameters}
}
\value{
An omicscope object with updated assays containing the count matrix and
updated rowData containing only genes present in the count matrix
}
\description{
This function performs read counting for RNA-seq data using the Rsubread::featureCounts
function. It takes BAM files specified in the omicscope object and counts reads
overlapping with genomic features defined in a GTF annotation file.
}
\details{
The function uses the following default parameters for featureCounts:
\itemize{
\item \code{isGTFAnnotationFile = TRUE}: Use GTF format annotation
\item \code{GTF.featureType = "exon"}: Count reads overlapping exons
\item \code{GTF.attrType = "gene_id"}: Use gene_id as primary identifier
\item \code{GTF.attrType.extra = c("gene_name","gene_biotype")}: Extract additional attributes
}

The resulting count matrix is stored as a sparse matrix (dgCMatrix) to save memory.
Column names of the count matrix correspond to sample names from the colData.
The rowData is filtered to include only genes present in the final count matrix.
}
\examples{
\dontrun{
# Basic usage with default parameters
os <- count_data(os)

# For single-end data with multiple threads
os <- count_data(os, rna_pairedEnd = FALSE, nThreads = 4)

# With custom featureCounts parameters
os <- count_data(os,
                 nThreads = 8,
                 featureCounts_params = list(
                   minMQS = 10,
                   strandSpecific = 2
                 ))
}

}
\seealso{
\code{\link[Rsubread]{featureCounts}} for detailed information about the underlying
counting function and its parameters
}
