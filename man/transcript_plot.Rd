% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visualization-supps.R
\name{transcript_plot}
\alias{transcript_plot}
\title{Plot Gene and Transcript Models from GTF}
\usage{
transcript_plot(
  gtf_file = NULL,
  target_gene = NULL,
  target_region = NULL,
  extend_up = 0,
  extend_down = 0,
  gene_order = NULL,
  region_order = NULL,
  remove_labelY = FALSE,
  collapse_exon = FALSE,
  show_utr = TRUE,
  arrow_length = 1.2,
  arrow_linewidth = 0.3,
  arrow_col = "black",
  exon_col = "black",
  exon_linewidth = 6,
  add_backsqure = TRUE,
  add_gene_label = FALSE,
  gene_label_size = 3,
  gene_label_aes = "gene_name",
  gene_label_vjust = 0,
  highlight_region = NULL,
  highlight_col_aes = "seqnames",
  highlight_col = NULL,
  highlight_alpha = 0.2
)
}
\arguments{
\item{gtf_file}{Path to a GTF file or a \code{GRanges} object containing gene annotations.}

\item{target_gene}{A character vector of one or more target gene names (e.g., from the \code{gene_name}
attribute in the GTF) to visualize.}

\item{target_region}{A character vector specifying genomic regions in the format
"chr:start-end" (e.g., "chr1:1000000-2000000"). Defaults to NULL. Either \code{target_gene}
or \code{target_region} must be provided.}

\item{extend_up}{Numeric. The number of base pairs to extend the visualization
region upstream from the gene's start. \strong{Effective only when \code{target_gene} is used.}
Defaults to 0.}

\item{extend_down}{Numeric. The number of base pairs to extend the visualization
region downstream from the gene's end. \strong{Effective only when \code{target_gene} is used.}
Defaults to 0.}

\item{gene_order}{A character vector to specify the display order of genes in the facets.}

\item{region_order}{A character vector to specify the display order of regions in the facets.
Defaults to NULL.}

\item{remove_labelY}{Logical. If \code{TRUE}, removes Y-axis tick labels and marks.
Defaults to \code{FALSE}.}

\item{collapse_exon}{Logical. If \code{TRUE}, all transcripts of a gene are collapsed
into a single, flattened gene model for display. Defaults to \code{FALSE}.}

\item{show_utr}{Logical. If \code{TRUE} (default), the gene model will visually distinguish
between CDS (thicker lines) and UTR (thinner lines) regions. If \code{FALSE}, all exons
will be displayed with the same thickness.}

\item{arrow_length}{Numeric. Controls the size of the arrowhead for the transcript
direction arrows. Defaults to 1.2.}

\item{arrow_linewidth}{Numeric. Controls the line width of the transcript direction
arrows. Defaults to 0.3.}

\item{arrow_col}{Character string. The color of the transcript direction arrows.
Defaults to "black".}

\item{exon_col}{Character string. The color of the exon segments in the gene model.
Defaults to "black".}

\item{exon_linewidth}{Numeric. The line width of the CDS or exon segments. Defaults to 6.}

\item{add_backsqure}{Logical. If \code{TRUE} (default), adds a background box to gene labels
when \code{add_gene_label} is \code{TRUE}. Uses \code{geom_label()} instead of \code{geom_text()}.}

\item{add_gene_label}{Logical. If \code{TRUE}, adds gene name labels to the gene/transcript models.
Defaults to \code{FALSE}.}

\item{gene_label_size}{Numeric. The size of the gene name labels. Defaults to 3.}

\item{gene_label_aes}{Character. Column name to use from GTF for gene labeling (like "gene_name", "gene_id").
Defaults to "gene_name".}

\item{gene_label_vjust}{\code{numeric}. Controls the vertical justification of gene labels.
A value of \code{0} aligns the bottom of the label with its y-coordinate
(placing it above the transcript line), while \code{0.5} centers it. Defaults to \code{0}.}

\item{highlight_region}{A data frame containing regions to be highlighted
on the plot. The object must include \code{start} and \code{end} columns, and a column
matching the faceting variable (\code{gene_name} or \code{target_region}). This allows overlaying
colored bands to mark specific features. Defaults to \code{NULL}.}

\item{highlight_col_aes}{A character string specifying the column in \code{highlight_region} data
to use for the \code{fill} aesthetic. This enables different regions to be colored based on a
categorical variable. Defaults to \code{"seqnames"}.}

\item{highlight_col}{A named character vector specifying the colors to use for the fill
scale of the highlighted regions. The names should correspond to the unique values in the
\code{highlight_col_aes} column. If \code{NULL} (default), the default ggplot2 color scale is used.}

\item{highlight_alpha}{Numeric. The transparency of the highlighted region fill, ranging from
0 (fully transparent) to 1 (fully opaque). Defaults to \code{0.2}.}
}
\value{
A \code{ggplot} object representing the transcript structure plot, which can be
printed or modified further.
}
\description{
This function visualizes gene and transcript structures from a GTF file for
specified genes or genomic regions. It uses ggplot2 to draw exons, UTRs, and
introns, including directionality arrows. The plot can be customized to show
individual transcripts or a collapsed gene model and can be faceted by gene
or region.
}
\examples{
\dontrun{
# This example requires an actual GTF file to run.
# The following shows the basic function call structure.

my_gtf <- "path/to/genes.gtf"
my_gene <- "SOX2"

# Plot a single gene structure showing all transcripts
p1 <- transcript_plot(
  gtf_file = my_gtf,
  target_gene = my_gene,
  extend_up = 5000,
  extend_down = 5000
)
print(p1)

# Plot a specific region, collapsing transcripts and adding labels
my_region <- "chr3:181711349-181714776" # A known region for SOX2
p2 <- transcript_plot(
  gtf_file = my_gtf,
  target_region = my_region,
  collapse_exon = TRUE,
  add_gene_label = TRUE,
  gene_label_size = 4
)
print(p2)

# Highlight a specific area within the plot
highlight_df <- data.frame(
  start = 181712000,
  end = 181713000,
  type = "enhancer",
  target_region = my_region # To ensure it plots on the correct facet
)
p3 <- transcript_plot(
  gtf_file = my_gtf,
  target_region = my_region,
  highlight_region = highlight_df,
  highlight_col_aes = "type",
  highlight_col = c("enhancer" = "lightgreen")
)
print(p3)
}
}
