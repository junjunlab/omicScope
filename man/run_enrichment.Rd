% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway-enrichment.R
\name{run_enrichment}
\alias{run_enrichment}
\alias{run_enrichment,omicscope-method}
\title{Run Functional Enrichment Analysis}
\usage{
run_enrichment(object, ...)

\S4method{run_enrichment}{omicscope}(
  object,
  enrich_type = c("go", "gsea_go", "kegg", "gsea_kegg"),
  OrgDb = NULL,
  organism = "hsa",
  pvalueCutoff = 1,
  enrich_fun_keytype = "ENTREZID",
  id_trans = TRUE,
  kegg_setReadable = TRUE
)
}
\arguments{
\item{object}{An \code{omicscope} object containing differential expression
results from \code{differential_expression()} method.}

\item{...}{Additional arguments (currently not used).}

\item{enrich_type}{Character string specifying the enrichment analysis type.
Options are:
\itemize{
\item \code{"go"} - Gene Ontology over-representation analysis
\item \code{"gsea_go"} - Gene Ontology gene set enrichment analysis
\item \code{"kegg"} - KEGG pathway over-representation analysis
\item \code{"gsea_kegg"} - KEGG pathway gene set enrichment analysis
}
Default is \code{"go"}.}

\item{OrgDb}{An organism database object (e.g., \code{org.Hs.eg.db} for human,
\code{org.Mm.eg.db} for mouse) used for gene ID conversion and annotation.
Required parameter.}

\item{organism}{Character string specifying the KEGG organism code
(e.g., "hsa" for human, "mmu" for mouse). Only used for KEGG analysis.
Default is \code{"hsa"}.}

\item{pvalueCutoff}{Numeric value specifying the p-value cutoff for
significance testing. Default is \code{1} (no filtering).}

\item{enrich_fun_keytype}{Character string. The \code{keyType} argument passed to
\code{clusterProfiler} functions, specifying the type of gene IDs used for enrichment.
Defaults to \code{"ENTREZID"}. Should not typically be changed unless you are using
non-standard gene identifiers.}

\item{id_trans}{Logical. If \code{TRUE} (default), the function attempts to
translate gene SYMBOLs to ENTREZ IDs. If \code{FALSE}, no translation is performed,
and the \code{gene_name} column is assumed to already contain the correct IDs.}

\item{kegg_setReadable}{Logical, applicable only to KEGG analyses (\code{"kegg"} or \code{"gsea_kegg"}).
If \code{TRUE} (default), ENTREZ IDs in the results are converted back to readable
gene SYMBOLs.}
}
\value{
An \code{omicscope} object with enrichment results stored in the
\code{enrichmentData} slot. The results include:
\itemize{
\item For ORA: separate results for up-regulated and down-regulated genes
\item For GSEA: ranked gene set enrichment results
\item Gene symbols are made readable in the final results
}
}
\description{
Performs functional enrichment analysis on differential expression results
using Gene Ontology (GO) or KEGG pathway databases. Supports both
over-representation analysis (ORA) and gene set enrichment analysis (GSEA).
}
\details{
This method performs functional enrichment analysis on previously computed
differential expression results. The analysis workflow includes:

\enumerate{
\item Gene ID conversion from gene symbols to Entrez IDs using \code{clusterProfiler::bitr()}
\item For ORA methods (\code{"go"}, \code{"kegg"}): separate analysis for
up-regulated and down-regulated genes
\item For GSEA methods (\code{"gsea_go"}, \code{"gsea_kegg"}): ranked gene
list analysis using log2 fold change values
\item Results are stored in the \code{enrichmentData} slot of the object
}

The method requires that differential expression analysis has been performed
first using the \code{differential_expression()} method.

For GO analysis, all three ontologies (Biological Process, Cellular Component,
Molecular Function) are analyzed simultaneously using \code{ont = "ALL"}.
}
\examples{
\dontrun{
# Load required libraries
library(org.Mm.eg.db)  # for mouse
library(org.Hs.eg.db)  # for human

# Assuming 'os' is an omicscope object with differential expression results

# GO over-representation analysis (mouse)
os_go <- run_enrichment(os,
                        enrich_type = "go",
                        OrgDb = org.Mm.eg.db)

# KEGG gene set enrichment analysis (human)
os_gsea <- run_enrichment(os,
                          enrich_type = "gsea_kegg",
                          OrgDb = org.Hs.eg.db,
                          organism = "hsa",
                          pvalueCutoff = 0.05)

# Access enrichment results
enrichment_results <- os_go@enrichmentData
}


}
