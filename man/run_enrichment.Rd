% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway-enrichment.R
\name{run_enrichment}
\alias{run_enrichment}
\alias{run_enrichment,omicscope-method}
\title{Perform Enrichment Analysis on Differential Expression Results}
\usage{
run_enrichment(object, ...)

\S4method{run_enrichment}{omicscope}(
  object,
  diff_data_selected = NULL,
  enrich_type = c("go", "gsea_go", "kegg", "gsea_kegg"),
  OrgDb = NULL,
  organism = "hsa",
  pvalueCutoff = 1
)
}
\arguments{
\item{object}{An \code{omicscope} S4 object containing differential expression results.
The object must have differential expression data in the \code{diffExpData} slot
(run \code{differential_expression} first).}

\item{...}{Additional arguments (currently not used).}

\item{diff_data_selected}{A character vector specifying which differential expression
comparisons to analyze. If \code{NULL} (default), all available comparisons will
be analyzed. Should match names in \code{object@diffExpData}.}

\item{enrich_type}{Character string specifying the type of enrichment analysis. Options are:
\itemize{
\item \code{"go"} - Gene Ontology over-representation analysis
\item \code{"gsea_go"} - Gene Ontology Gene Set Enrichment Analysis
\item \code{"kegg"} - KEGG pathway over-representation analysis
\item \code{"gsea_kegg"} - KEGG pathway Gene Set Enrichment Analysis
}}

\item{OrgDb}{An \code{OrgDb} annotation package object for gene ID conversion and
annotation. Required for all analysis types. Examples: \code{org.Hs.eg.db} for human,
\code{org.Mm.eg.db} for mouse. If \code{NULL}, the function will attempt to detect
the appropriate package but may fail.}

\item{organism}{A character string specifying the KEGG organism code for KEGG pathway
analysis. Default is \code{"hsa"} for human. Common codes include:
\itemize{
\item \code{"hsa"} - Homo sapiens (human)
\item \code{"mmu"} - Mus musculus (mouse)
\item \code{"rno"} - Rattus norvegicus (rat)
\item \code{"dme"} - Drosophila melanogaster (fruit fly)
}
Only used for KEGG analysis types.}

\item{pvalueCutoff}{A numeric value specifying the p-value cutoff for enrichment
significance. Default is 1 (no filtering). Common values are 0.05 or 0.01.}
}
\value{
Returns the input \code{omicscope} object with enrichment results stored
in the \code{enrichmentData} slot. Results can be accessed using
\code{object@enrichmentData[[comparison_name]]}.
}
\description{
This function performs functional enrichment analysis (Gene Ontology or KEGG pathway)
on differential expression data stored in an omicscope object. It supports both
over-representation analysis (ORA) and Gene Set Enrichment Analysis (GSEA).
}
\details{
The function performs the following steps:
\enumerate{
\item Validates that differential expression data exists in the object
\item For each selected comparison, extracts gene data and removes duplicates by selecting
the gene with the lowest p-value
\item Converts gene symbols to ENTREZ IDs using the provided OrgDb
\item Performs the specified enrichment analysis:
\itemize{
\item For ORA methods ("go", "kegg"): Analyzes significantly up- and down-regulated genes separately
\item For GSEA methods ("gsea_go", "gsea_kegg"): Uses ranked gene lists based on log2FoldChange
}
\item Stores results in the object's enrichmentData slot with descriptive names
}

For GO analysis, all three ontologies (BP, CC, MF) are analyzed together (ont = "ALL").
For KEGG analysis, results are made readable by converting ENTREZ IDs back to gene symbols.

The differential expression data must contain columns: \code{gene_name}, \code{pvalue},
\code{log2FoldChange}, and \code{type} (indicating "sigUp" or "sigDown").
}
\examples{
\dontrun{
# Load required packages
library(org.Hs.eg.db)  # for human

# Basic GO over-representation analysis
obj <- run_enrichment(obj,
                      enrich_type = "go",
                      OrgDb = org.Hs.eg.db,
                      pvalueCutoff = 0.05)

# KEGG pathway analysis for specific comparisons
obj <- run_enrichment(obj,
                      diff_data_selected = c("Treatment_vs_Control"),
                      enrich_type = "kegg",
                      OrgDb = org.Hs.eg.db,
                      organism = "hsa",
                      pvalueCutoff = 0.05)

# Gene Set Enrichment Analysis for GO
obj <- run_enrichment(obj,
                      enrich_type = "gsea_go",
                      OrgDb = org.Hs.eg.db,
                      pvalueCutoff = 0.25)

# Mouse analysis
library(org.Mm.eg.db)
obj <- run_enrichment(obj,
                      enrich_type = "gsea_kegg",
                      OrgDb = org.Mm.eg.db,
                      organism = "mmu")

# Access results
enrich_results <- obj@enrichmentData
go_results <- obj@enrichmentData[["Treatment_vs_Control"]]
}

}
